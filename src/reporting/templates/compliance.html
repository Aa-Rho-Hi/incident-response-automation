
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Compliance Report - {{ month }}</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 24px; }
    h1 { margin-bottom: 4px; }
    h2 { margin-top: 28px; }
    table { border-collapse: collapse; width: 100%; margin: 12px 0; }
    th, td { border: 1px solid #ddd; padding: 8px; font-size: 12px; }
    th { background: #f4f4f4; text-align: left; }
    .kpi { display: inline-block; margin-right: 24px; padding: 8px 12px; background:#f7fafc; border:1px solid #e2e8f0; border-radius: 8px;}
    .badge { padding: 2px 6px; border-radius: 4px; background: #edf2ff; border:1px solid #c7d2fe; }
  </style>
</head>
<body>
  <h1>Compliance Report</h1>
  <div>Month: <strong>{{ month }}</strong></div>
  <div class="kpi">Total Events: <strong>{{ kpis.total_events }}</strong></div>
  <div class="kpi">High Severity: <strong>{{ kpis.high_sev }}</strong></div>
  <div class="kpi">Unique Hosts: <strong>{{ kpis.unique_hosts }}</strong></div>
  <div class="kpi">Users Touched: <strong>{{ kpis.unique_users }}</strong></div>

  <h2>Sections</h2>
  {% for section in sections %}
    <h3>{{ loop.index }}. {{ section.title }}</h3>
    <p>{{ section.description }}</p>
    <table>
      <thead><tr>
        {% for h in section.headers %}<th>{{ h }}</th>{% endfor %}
      </tr></thead>
      <tbody>
        {% for row in section.rows %}
          <tr>
            {% for h in section.headers %}
              <td>{{ row.get(h, "") }}</td>
            {% endfor %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endfor %}

  <p style="margin-top:24px;color:#666;">Generated: {{ generated_at }}</p>
</body>
</html>
